<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Java中的泛型 - H2oLo</title><meta name="Description" content="cheysen的个人博客"><meta property="og:title" content="Java中的泛型" />
<meta property="og:description" content="概述 泛型可以使得在编译期发现bug,从而增加代码稳定性。泛型使得在定义类、接口和方法时类型（类和接口）可以被参数化。就像方法声明中使用的形参" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://heysen.xyz/java%E6%B3%9B%E5%9E%8B/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-04-14T21:06:15+08:00" />
<meta property="article:modified_time" content="2025-04-14T21:06:15+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Java中的泛型"/>
<meta name="twitter:description" content="概述 泛型可以使得在编译期发现bug,从而增加代码稳定性。泛型使得在定义类、接口和方法时类型（类和接口）可以被参数化。就像方法声明中使用的形参"/>
<meta name="application-name" content="H2oLo">
<meta name="apple-mobile-web-app-title" content="H2oLo"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://heysen.xyz/java%E6%B3%9B%E5%9E%8B/" /><link rel="prev" href="https://heysen.xyz/b%E6%A0%91%E4%B8%8Eb-%E6%A0%91/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Java中的泛型",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/heysen.xyz\/java%E6%B3%9B%E5%9E%8B\/"
        },"genre": "posts","keywords": "Java基础","wordcount":  9479 ,
        "url": "https:\/\/heysen.xyz\/java%E6%B3%9B%E5%9E%8B\/","datePublished": "2025-04-14T21:06:15+08:00","dateModified": "2025-04-14T21:06:15+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": " "
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="H2oLo"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/hydrogen.png"
        data-srcset="/images/hydrogen.png, /images/hydrogen.png 1.5x, /images/hydrogen.png 2x"
        data-sizes="auto"
        alt="/images/hydrogen.png"
        title="/images/hydrogen.png" /><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="H2oLo"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/hydrogen.png"
        data-srcset="/images/hydrogen.png, /images/hydrogen.png 1.5x, /images/hydrogen.png 2x"
        data-sizes="auto"
        alt="/images/hydrogen.png"
        title="/images/hydrogen.png" /><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Java中的泛型</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-category"><a href="/categories/java%E7%BC%96%E7%A8%8B/"><i class="far fa-folder fa-fw"></i>Java编程</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2025-04-14">2025-04-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 9479 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 19 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#概述">概述</a></li>
    <li><a href="#泛型类型">泛型类型</a>
      <ul>
        <li><a href="#原始类型">原始类型</a></li>
      </ul>
    </li>
    <li><a href="#泛型方法">泛型方法</a></li>
    <li><a href="#边界类型参数">边界类型参数</a>
      <ul>
        <li><a href="#泛型方法中的边界类型参数">泛型方法中的边界类型参数</a></li>
      </ul>
    </li>
    <li><a href="#泛型中的继承和子类型">泛型中的继承和子类型</a></li>
    <li><a href="#类型推断">类型推断</a>
      <ul>
        <li><a href="#泛型方法中的类型推断">泛型方法中的类型推断</a></li>
        <li><a href="#实例化泛型类中的类型推断">实例化泛型类中的类型推断</a></li>
        <li><a href="#泛型构造器中的类型推断">泛型构造器中的类型推断</a></li>
        <li><a href="#目标类型">目标类型</a></li>
      </ul>
    </li>
    <li><a href="#通配符">通配符</a>
      <ul>
        <li><a href="#上界通配符">上界通配符</a></li>
        <li><a href="#无界通配符">无界通配符</a></li>
        <li><a href="#下界通配符">下界通配符</a></li>
        <li><a href="#通配符和子类型">通配符和子类型</a></li>
        <li><a href="#通配符捕获和辅助方法">通配符捕获和辅助方法</a></li>
        <li><a href="#使用指南">使用指南</a></li>
      </ul>
    </li>
    <li><a href="#类型擦除">类型擦除</a>
      <ul>
        <li><a href="#泛型类中的擦除">泛型类中的擦除</a></li>
        <li><a href="#泛型方法中的擦除">泛型方法中的擦除</a></li>
        <li><a href="#类型擦除的影响和桥接方法">类型擦除的影响和桥接方法</a></li>
        <li><a href="#非具体类型non-reifiable-types">非具体类型（Non-Reifiable Types）</a></li>
      </ul>
    </li>
    <li><a href="#泛型约束">泛型约束</a>
      <ul>
        <li><a href="#不能使用原始类型实例化泛型类型">不能使用原始类型实例化泛型类型</a></li>
        <li><a href="#不能创建类型参数的实例">不能创建类型参数的实例</a></li>
        <li><a href="#不能声明为静态属性">不能声明为静态属性</a></li>
        <li><a href="#不能转换或使用instanceof语句">不能转换或使用instanceof语句</a></li>
        <li><a href="#不能创建参数化类型的数组">不能创建参数化类型的数组</a></li>
        <li><a href="#不能创建捕获或抛出参数化类型的对象">不能创建，捕获或抛出参数化类型的对象</a></li>
        <li><a href="#参数在类型擦除后一眼的方法不能重载">参数在类型擦除后一眼的方法不能重载</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="概述">概述</h1>
<p>泛型可以使得在编译期发现bug,从而增加代码稳定性。泛型使得在定义类、接口和方法时类型（类和接口）可以被参数化。就像方法声明中使用的形参，类型参数对于不同的输入可以重用代码。不同点在于形参的输入是值，类型参数的输入是类型。</p>
<p>使用泛型有诸多益处：</p>
<ul>
<li>
<p>编译器强类型检查：Java编译器对泛型代码运行强类型检查，如果代码类型不安全则报错。修复编译器错误总比修复运行时错误简单</p>
</li>
<li>
<p>消除转换：</p>
<p>下面代码端需要转换</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;hello&#34;</span><span class="o">);</span>
<span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>使用泛型则不需要转换</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;hello&#34;</span><span class="o">);</span>
<span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>   <span class="c1">// no cast
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>提供实现通用算法的能力:通过泛型,程序员能实现集合上不同类型的通用算法,这些算法可以自定义,类型安全且更易读</p>
</li>
</ul>
<h1 id="泛型类型">泛型类型</h1>
<p>泛型类型是类型参数化的泛型类或泛型接口。</p>
<p>以一个示例展示泛型的使用，下面非泛型的Box类适用于任何类型的对象</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Box</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Object</span> <span class="n">object</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">Object</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">object</span> <span class="o">=</span> <span class="n">object</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">object</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>因为它的方法接受或返回一个Object对象,所以你可以传入除原始类型外的任何对象。但在运行时无法验证该类如何被使用。一部分代码可能使用Integer并期望输出Integer，同时另一部分代码可能错误地传入String,这将导致运行时错误。</p>
<p>泛型类的定义格式如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">name</span><span class="o">&lt;</span><span class="n">T1</span><span class="o">,</span> <span class="n">T2</span><span class="o">,</span> <span class="o">...,</span> <span class="n">Tn</span><span class="o">&gt;</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>将泛型应用到Box类上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * Generic version of the Box class.
</span><span class="cm"> * @param &lt;T&gt; the type of the value being boxed
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Box</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">// T stands for &#34;Type&#34;
</span><span class="c1"></span>    <span class="kd">private</span> <span class="n">T</span> <span class="n">t</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">t</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>类型变量可以是任何非原始类型:任意类、接口、数组甚至是其它类型变量。</p>
<p><strong>类型参数命名约定</strong></p>
<p>约定类型参数命名是单个大写字母，常见的类型参数名称如下：</p>
<ul>
<li>E-Element(在Java集合框架中常用)</li>
<li>K-Key</li>
<li>N-Number</li>
<li>T-Type</li>
<li>V-Value</li>
<li>S,U,V等</li>
</ul>
<p><strong>调用并实例化泛型类型</strong></p>
<p>要使用泛型类,必须以具体的类型值代替泛型定义。如使用Box类<code>Box&lt;Integer&gt; integerBox;</code>可以把泛型类调用类比普通方法调用,只不过传递的是类型参数（就像上面传递的是Integer）。</p>
<blockquote>
<p>type paramaeter与type argument术语:</p>
<p>编码时,type argument用来创建一个参数化的类型。如Foo&lt;T&gt;中的T是type paramaeter，Foo&lt;String&gt;中的String是type argument</p>
</blockquote>
<p>泛型类型的调用也叫类型参数化。泛型类的实例化如下例子:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">integerBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
<span class="c1">//java 7之后,编译器可以从上下文中确定或推断类型参数
</span><span class="c1"></span><span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">integerBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;&gt;();</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>多类型参数</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">K</span> <span class="nf">getKey</span><span class="o">();</span>
    <span class="kd">public</span> <span class="n">V</span> <span class="nf">getValue</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderedPair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">K</span> <span class="n">key</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">V</span> <span class="n">value</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderedPair</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">;</span>
	<span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">K</span> <span class="nf">getKey</span><span class="o">()</span>	<span class="o">{</span> <span class="k">return</span> <span class="n">key</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">V</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="n">OrderedPair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrderedPair</span><span class="o">&lt;&gt;(</span><span class="s">&#34;Even&#34;</span><span class="o">,</span> <span class="n">8</span><span class="o">);</span><span class="c1">//自动装箱使得可以传入原始类型
</span><span class="c1"></span><span class="n">OrderedPair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span>  <span class="n">p2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrderedPair</span><span class="o">&lt;&gt;(</span><span class="s">&#34;hello&#34;</span><span class="o">,</span> <span class="s">&#34;world&#34;</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>参数化类型</strong></p>
<p>可以将类型参数(如K,V)替换为参数化类型(如List&lt;String&gt;)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">OrderedPair</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OrderedPair</span><span class="o">&lt;&gt;(</span><span class="s">&#34;primes&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(...));</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="原始类型">原始类型</h2>
<p>原始类型是不带任何类型参数的泛型类或泛型接口。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Box</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>
<span class="c1">//参数化定义
</span><span class="c1"></span><span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">intBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;&gt;();</span>
<span class="c1">//Box&lt;T&gt;的原始类型
</span><span class="c1"></span><span class="n">Box</span> <span class="n">rawBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div><p>Box是Box&lt;T&gt;的原始类型,但是非泛型类或接口不是原始类型。</p>
<p>原始类型在旧版代码中出现，因为那是许多API类（像Collections）不支持泛型。当使用原始类型时，实际上是一种预泛型行为:Box的f泛型参数被参数化为Object。为了向后兼容，将参数化类型赋值给原始类型是允许的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Box</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;&gt;();</span>
<span class="n">Box</span> <span class="n">rawBox</span> <span class="o">=</span> <span class="n">stringBox</span><span class="o">;</span>               <span class="c1">// OK
</span></code></pre></td></tr></table>
</div>
</div><p>但是反过来你会得到一个警告:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Box</span> <span class="n">rawBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">();</span>           <span class="c1">// rawBox is a raw type of Box&lt;T&gt;
</span><span class="c1"></span><span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">intBox</span> <span class="o">=</span> <span class="n">rawBox</span><span class="o">;</span>     <span class="c1">// warning: unchecked conversion
</span></code></pre></td></tr></table>
</div>
</div><p>如果你用原始类型来调用泛型类的方法同样会得到警告:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="c1">//这段代码不会报错,stringBox在运行时存储的值为&lt;Integer&gt;类型
</span><span class="c1"></span><span class="n">Box</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;&gt;();</span>
<span class="n">Box</span> <span class="n">rawBox</span> <span class="o">=</span> <span class="n">stringBox</span><span class="o">;</span>
<span class="n">rawBox</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">8</span><span class="o">);</span>  <span class="c1">// warning: unchecked invocation to set(T) 这表明原始类型绕过了泛型类型检查
</span></code></pre></td></tr></table>
</div>
</div><p><strong>未受检错误信息</strong></p>
<p>当在旧版本代码中使用泛型代码时,可能出现以下警告信息:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-tex" data-lang="tex">Note: Example.java uses unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
</code></pre></td></tr></table>
</div>
</div><p>这通常在旧版API中使用原始类型时出现：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WarningDemo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">bi</span><span class="o">;</span>
        <span class="n">bi</span> <span class="o">=</span> <span class="n">createBox</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="n">Box</span> <span class="nf">createBox</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Box</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>&ldquo;unchecked&quot;意味着编译器没有足够的类型信息执行所有的类型检查来确保类型安全。使用<code>-Xlint:unchecked</code>重新编译来查看所有'&ldquo;unchecked&quot;警告：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-tex" data-lang="tex">WarningDemo.java:4: warning: [unchecked] unchecked conversion
found   : Box
required: Box&lt;java.lang.Integer&gt;
        bi = createBox();
                      <span class="nb">^</span>
1 warning
</code></pre></td></tr></table>
</div>
</div><p>可以用<code>-Xlint:-unchecked</code>禁用未受检警告；<code>@SuppressWarnings(&quot;unchecked&quot;)</code>注解会抑制未受检警告。</p>
<h1 id="泛型方法">泛型方法</h1>
<p>泛型方法是引入自己的类型参数的方法。与声明泛型类型相似，但是其类型参数的作用域限制在方法内。静态、非静态泛型方法以及泛型类构造器都合法。</p>
<p>泛型方法的语法包含出现在方法返回类型前的类型参数列表。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Util</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="kt">boolean</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">p1</span><span class="o">,</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">p2</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">p1</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">p2</span><span class="o">.</span><span class="na">getKey</span><span class="o">())</span> <span class="o">&amp;&amp;</span>
               <span class="n">p1</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">p2</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">K</span> <span class="n">key</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">V</span> <span class="n">value</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Pair</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setKey</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValue</span><span class="o">(</span><span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">K</span> <span class="nf">getKey</span><span class="o">()</span>   <span class="o">{</span> <span class="k">return</span> <span class="n">key</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">V</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>泛型方法的调用如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Pair</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;&gt;(</span><span class="n">1</span><span class="o">,</span> <span class="s">&#34;apple&#34;</span><span class="o">);</span>
<span class="n">Pair</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;&gt;(</span><span class="n">2</span><span class="o">,</span> <span class="s">&#34;pear&#34;</span><span class="o">);</span>
<span class="kt">boolean</span> <span class="n">same</span> <span class="o">=</span> <span class="n">Util</span><span class="o">.&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span><span class="n">compare</span><span class="o">(</span><span class="n">p1</span><span class="o">,</span> <span class="n">p2</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>当省略明确的类型时,编译器将推断具体的类型:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Pair</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;&gt;(</span><span class="n">1</span><span class="o">,</span> <span class="s">&#34;apple&#34;</span><span class="o">);</span>
<span class="n">Pair</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">p2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;&gt;(</span><span class="n">2</span><span class="o">,</span> <span class="s">&#34;pear&#34;</span><span class="o">);</span>
<span class="kt">boolean</span> <span class="n">same</span> <span class="o">=</span> <span class="n">Util</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">p1</span><span class="o">,</span> <span class="n">p2</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="边界类型参数">边界类型参数</h1>
<p>如果我们想限制作为类型参数的参数化类型,如一个针对数字操作的方法仅接受Number及其子类,可以使用有界类型参数。</p>
<p>要声明有界类型参数，列出类型参数名称，后面加上extends关键字，然后是它的上界。在这种情况下，extends是广义的意味着&quot;extends(类)&ldquo;或&quot;implements(接口)&quot;。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Box</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">T</span> <span class="n">t</span><span class="o">;</span>          

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">U</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">inspect</span><span class="o">(</span><span class="n">U</span> <span class="n">u</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;T: &#34;</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;U: &#34;</span> <span class="o">+</span> <span class="n">u</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">integerBox</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">integerBox</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>
        <span class="c1">//使用了有界泛型参数,编译器失败
</span><span class="c1"></span>        <span class="n">integerBox</span><span class="o">.</span><span class="na">inspect</span><span class="o">(</span><span class="s">&#34;some text&#34;</span><span class="o">);</span> <span class="c1">// error: this is still String!
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>有界泛型参数除了限制类型外,你还可以用起实例调用边界类型的方法:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NaturalNumber</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">T</span> <span class="n">n</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">NaturalNumber</span><span class="o">(</span><span class="n">T</span> <span class="n">n</span><span class="o">)</span>  <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEven</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="na">intValue</span><span class="o">()</span> <span class="o">%</span> <span class="n">2</span> <span class="o">==</span> <span class="n">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>多边界</strong></p>
<p>一个类型参数可以有多个边界:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">B1</span> <span class="o">&amp;</span> <span class="n">B2</span> <span class="o">&amp;</span> <span class="n">B3</span><span class="o">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>有多个边界的类型变量是所有边界类型的子类型。如果有一个边界是类，它必须先声明(否则编译不通过)，例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Class</span> <span class="n">A</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="kd">interface</span> <span class="nc">B</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="kd">interface</span> <span class="nc">C</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>

<span class="kd">class</span> <span class="nc">D</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">A</span> <span class="o">&amp;</span> <span class="n">B</span> <span class="o">&amp;</span> <span class="n">C</span><span class="o">&gt;</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="泛型方法中的边界类型参数">泛型方法中的边界类型参数</h2>
<p>有界类型参数是实现泛型算法的关键。下面的泛型使用会出现编译错误：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">int</span> <span class="nf">countGreaterThan</span><span class="o">(</span><span class="n">T</span><span class="o">[]</span> <span class="n">anArray</span><span class="o">,</span> <span class="n">T</span> <span class="n">elem</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="n">e</span> <span class="o">:</span> <span class="n">anArray</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">&gt;</span> <span class="n">elem</span><span class="o">)</span>  <span class="c1">// compiler error
</span><span class="c1"></span>            <span class="o">++</span><span class="n">count</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>因为&rdquo;&gt;&ldquo;操作符只能运用于原始类型,可以使用以Comparable&lt;T&gt;为上界的类型参数修复:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="kt">int</span> <span class="nf">countGreaterThan</span><span class="o">(</span><span class="n">T</span><span class="o">[]</span> <span class="n">anArray</span><span class="o">,</span> <span class="n">T</span> <span class="n">elem</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="n">e</span> <span class="o">:</span> <span class="n">anArray</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">elem</span><span class="o">)</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span>
            <span class="o">++</span><span class="n">count</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="泛型中的继承和子类型">泛型中的继承和子类型</h1>
<p>把一种类型的对象赋值给另一种类型的对象在某些情况下是可行的。例如，你可以把Integer的对象赋值给Object的，因为Object是Integer的超类：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Object</span> <span class="n">someObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
<span class="n">Integer</span> <span class="n">someInteger</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
<span class="n">someObject</span> <span class="o">=</span> <span class="n">someInteger</span><span class="o">;</span>   <span class="c1">// OK
</span></code></pre></td></tr></table>
</div>
</div><p>因为Integer也是Number的子类型,所以以下代码也合法:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someMethod</span><span class="o">(</span><span class="n">Number</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>

<span class="n">someMethod</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>   <span class="c1">// OK
</span><span class="c1"></span><span class="n">someMethod</span><span class="o">(</span><span class="k">new</span> <span class="n">Double</span><span class="o">(</span><span class="n">10</span><span class="o">.</span><span class="na">1</span><span class="o">));</span>   <span class="c1">// OK
</span></code></pre></td></tr></table>
</div>
</div><p>泛型也适用以上的赋值法则:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Box</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">box</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;();</span>
<span class="n">box</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>   <span class="c1">// OK
</span><span class="c1"></span><span class="n">box</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Double</span><span class="o">(</span><span class="n">10</span><span class="o">.</span><span class="na">1</span><span class="o">));</span>  <span class="c1">// OK
</span></code></pre></td></tr></table>
</div>
</div><p>考虑以下代码:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">boxTest</span><span class="o">(</span><span class="n">Box</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>该方法不能接受Box&lt;Integer&gt;或Box&lt;Double&gt;为入参,因为它们都不是Box&lt;Number&gt;的子类型。</p>
<blockquote>
<p>给定类型A和B，MyClass&lt;A&gt;和MyClass&lt;B&gt;没有从属关系,它们的父类都是Object。</p>
</blockquote>
<p><strong>泛型类和其子类</strong></p>
<p>你可以通过继承或实现来子类化一个泛型类或接口。</p>
<p>以Collections类举例,<code>ArrayList&lt;E&gt;</code>实现<code>List&lt;E&gt;</code>,<code>List&lt;E&gt;</code>继承<code>Collection&lt;E&gt;</code>。</p>
<p>自定义一个list接口<code>PayloadList</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">PayloadList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">,</span><span class="n">P</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kt">void</span> <span class="nf">setPayload</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="n">P</span> <span class="n">val</span><span class="o">);</span>
  <span class="o">...</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>下列参数化的PayloadList是List&lt;String&gt;的子类型:</p>
<ul>
<li>PayloadList&lt;String,String&gt;</li>
<li>PayloadList&lt;String,Integer&gt;</li>
<li>PayloadList&lt;String,Exception&gt;</li>
</ul>
<h1 id="类型推断">类型推断</h1>
<p>类型推断是Java编译器确定具体的类型参数来使方法调用和声明可用的能力。类型推断算法确定参数的类型，该类型赋值给返回值或直接返回。最后，推断算法找到适用于所有参数的最合适的类型。</p>
<p>下面的例子，推断确定了传递给pick方法的两个参数是<code>Serializable</code>类型。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">pick</span><span class="o">(</span><span class="n">T</span> <span class="n">a1</span><span class="o">,</span> <span class="n">T</span> <span class="n">a2</span><span class="o">)</span> <span class="o">{</span> <span class="k">return</span> <span class="n">a2</span><span class="o">;</span> <span class="o">}</span>
<span class="n">Serializable</span> <span class="n">s</span> <span class="o">=</span> <span class="n">pick</span><span class="o">(</span><span class="s">&#34;d&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;());</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="泛型方法中的类型推断">泛型方法中的类型推断</h2>
<p>类型推断可以让你像调用普通方法一样调用泛型方法。看看下面的例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoxDemo</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">addBox</span><span class="o">(</span><span class="n">U</span> <span class="n">u</span><span class="o">,</span> 
      <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">List</span><span class="o">&lt;</span><span class="n">Box</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&gt;</span> <span class="n">boxes</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Box</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="n">box</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Box</span><span class="o">&lt;&gt;();</span>
    <span class="n">box</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">u</span><span class="o">);</span>
    <span class="n">boxes</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">box</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">outputBoxes</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">List</span><span class="o">&lt;</span><span class="n">Box</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&gt;</span> <span class="n">boxes</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Box</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="n">box</span><span class="o">:</span> <span class="n">boxes</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">U</span> <span class="n">boxContents</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Box #&#34;</span> <span class="o">+</span> <span class="n">counter</span> <span class="o">+</span> <span class="s">&#34; contains [&#34;</span> <span class="o">+</span>
             <span class="n">boxContents</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">);</span>
      <span class="n">counter</span><span class="o">++;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ArrayList</span><span class="o">&lt;</span><span class="n">Box</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">listOfIntegerBoxes</span> <span class="o">=</span>
      <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="n">BoxDemo</span><span class="o">.&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="n">addBox</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">10</span><span class="o">),</span> <span class="n">listOfIntegerBoxes</span><span class="o">);</span>
    <span class="n">BoxDemo</span><span class="o">.</span><span class="na">addBox</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">20</span><span class="o">),</span> <span class="n">listOfIntegerBoxes</span><span class="o">);</span>
    <span class="n">BoxDemo</span><span class="o">.</span><span class="na">addBox</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">30</span><span class="o">),</span> <span class="n">listOfIntegerBoxes</span><span class="o">);</span>
    <span class="n">BoxDemo</span><span class="o">.</span><span class="na">outputBoxes</span><span class="o">(</span><span class="n">listOfIntegerBoxes</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//输出
</span><span class="c1"></span><span class="n">Box</span> <span class="err">#</span><span class="n">0</span> <span class="n">contains</span> <span class="o">[</span><span class="n">10</span><span class="o">]</span>
<span class="n">Box</span> <span class="err">#</span><span class="n">1</span> <span class="n">contains</span> <span class="o">[</span><span class="n">20</span><span class="o">]</span>
<span class="n">Box</span> <span class="err">#</span><span class="n">2</span> <span class="n">contains</span> <span class="o">[</span><span class="n">30</span><span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>addBox方法定义了一个名为U的类型参数,通常Java编译器能推断调用的泛型方法的类型参数。所以多数情况下不用具体说明。例如，调用addBox方法,你可以使用具体的类型参数:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">BoxDemo</span><span class="o">.&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="n">addBox</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">10</span><span class="o">),</span> <span class="n">listOfIntegerBoxes</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>相应的,如果你省略类型参数,Java编译器从方法参数中自动推断类型参数的类型为Integer:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">BoxDemo</span><span class="o">.</span><span class="na">addBox</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">20</span><span class="o">),</span> <span class="n">listOfIntegerBoxes</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="实例化泛型类中的类型推断">实例化泛型类中的类型推断</h2>
<p>泛型类实例化时,你可以在实例化的<code>&lt;&gt;</code>符号中省略类型参数,但是你不能省略<code>&lt;&gt;</code>符号,否则会被认为是原始类型:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">myMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
<span class="c1">//省略类型参数
</span><span class="c1"></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">myMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="c1">//未受检警告
</span><span class="c1"></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">myMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span> <span class="c1">// unchecked conversion warning
</span></code></pre></td></tr></table>
</div>
</div><h2 id="泛型构造器中的类型推断">泛型构造器中的类型推断</h2>
<p>泛型构造器可以存在于泛型类和非泛型类中，泛型构造器可以有自己的形式类型参数。如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">MyClass</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">MyClass</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...
</span><span class="c1"></span>  <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>考虑下面MyClass的实例化:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">MyClass</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">myObject1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyClass</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="s">&#34;&#34;</span><span class="o">)</span>
<span class="c1">//省略版
</span><span class="c1"></span><span class="n">MyClass</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">myObject2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyClass</span><span class="o">&lt;&gt;(</span><span class="s">&#34;&#34;</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>该语句定义了参数化类型的MyClass&lt;Integer&gt;,它表明类型参数X的类型是Integer。同时，编译器推断类型参数T的类型是String。</p>
<h2 id="目标类型">目标类型</h2>
<p>Java编译器利用目标输入来判断泛型方法调用的类型参数。表达式的目标类型是Java编译器期望的数据类型，具体取决于表达式出现的位置。考虑<code>Collections.emptyList</code>方法，其定义如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">emptyList</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div><p>考虑下面的赋值语句:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">listOne</span> <span class="o">=</span> <span class="n">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div><p>该表达式期望一个<code>List&lt;String&gt;</code>的实例,这种数据类型是目标类型。因为emptyList方法返回List&lt;T&gt;,编译器推断类型参数T必须是String。这在Java7和Java8中都适用。</p>
<p>但以下例子存在不同：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kt">void</span> <span class="nf">processStringList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringList</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// process stringList
</span><span class="c1"></span><span class="o">}</span>

<span class="c1">//这在Java7中无法编译,因为List&lt;T&gt;在Java7中认为需要List&lt;Object&gt;
</span><span class="c1"></span><span class="n">processStringList</span><span class="o">(</span><span class="n">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">());</span>
<span class="c1">//在Java7中可以编译通过
</span><span class="c1"></span><span class="n">processStringList</span><span class="o">(</span><span class="n">Collections</span><span class="o">.&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="n">emptyList</span><span class="o">());</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="通配符">通配符</h1>
<p>泛型代码中,&rdquo;?&ldquo;叫作通配符，代表着一种未知类型。通配符可以在众多场景中使用：作为从参数类型、字段或者本地变量；有时甚至可以是返回类型。通配符不能用在泛型方法调用的类型参数、泛型类实例创建或超类。</p>
<h2 id="上界通配符">上界通配符</h2>
<p>你可以使用上界通配符放大变量的限制。例如你想写一个能在List&lt;Integer&gt;中运行的方法,就可以使用上界通配符实现。</p>
<p>使用如&lt;? extends A&gt;声明。在这种情况下，extends是广义的意味着&quot;extends(类)&ldquo;或&quot;implements(接口)&quot;。</p>
<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Foo</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Foo</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Foo</span> <span class="n">elem</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// elem可以使用任何定义在Foo类中的方法。
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">sumOfList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">double</span> <span class="n">s</span> <span class="o">=</span> <span class="n">0</span><span class="o">.</span><span class="na">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Number</span> <span class="n">n</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">n</span><span class="o">.</span><span class="na">doubleValue</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">&gt;</span> <span class="n">ld</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">1</span><span class="o">.</span><span class="na">2</span><span class="o">,</span> <span class="n">2</span><span class="o">.</span><span class="na">3</span><span class="o">,</span> <span class="n">3</span><span class="o">.</span><span class="na">5</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;sum = &#34;</span> <span class="o">+</span> <span class="n">sumOfList</span><span class="o">(</span><span class="n">ld</span><span class="o">));</span><span class="c1">//sum=7.0
</span></code></pre></td></tr></table>
</div>
</div><h2 id="无界通配符">无界通配符</h2>
<p>无界通配符如:List&lt;?&gt;意为未知类型的列表。有两种场景适用无界通配符:</p>
<ul>
<li>如果你在编写一个能用Object类提供的方法实现的方法</li>
<li>当代码使用了泛型类中不依赖于类型参数的方法，例如List.size或List.clear。Class&lt;?&gt;就经常被使用,因为Class&lt;T&gt;中的多数方法不依赖T。</li>
</ul>
<p>考虑下面的printList方法:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Object</span> <span class="n">elem</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">elem</span> <span class="o">+</span> <span class="s">&#34; &#34;</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>printList并不能打印任何类型的列表,它仅打印Object实例。因为像例如List&lt;Integer&gt;不是List&lt;Object&gt;的子类型。使用无界通配符可实现打印任意类型列表：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Object</span> <span class="n">elem</span><span class="o">:</span> <span class="n">list</span><span class="o">)</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">elem</span> <span class="o">+</span> <span class="s">&#34; &#34;</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
<span class="o">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">li</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">2</span><span class="o">,</span> <span class="n">3</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span>  <span class="n">ls</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&#34;one&#34;</span><span class="o">,</span> <span class="s">&#34;two&#34;</span><span class="o">,</span> <span class="s">&#34;three&#34;</span><span class="o">);</span>
<span class="n">printList</span><span class="o">(</span><span class="n">li</span><span class="o">);</span>
<span class="n">printList</span><span class="o">(</span><span class="n">ls</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>List&lt;Object&gt;与List&lt;?&gt;是不同的,你可以往List&lt;Object&gt;插入Object或任意Object的子类型,但你仅能插入null到List&lt;?&gt;。</p>
<h2 id="下界通配符">下界通配符</h2>
<p>下界通配符将未知类型限定为特定类型或该类型的超类,使用&lt;? super A&gt;声明。下界通配符与上界通配符不能同时使用。</p>
<h2 id="通配符和子类型">通配符和子类型</h2>
<p>可以使用通配符创建泛型中的类型关系,尽管List&lt;Integer&gt;和List&lt;Number&gt;没有关系,但是它们的父类型都是List&lt;?&gt;。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">intList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span>  <span class="n">numList</span> <span class="o">=</span> <span class="n">intList</span><span class="o">;</span>  <span class="c1">// OK. List&lt;? extends Integer&gt; is a subtype of List&lt;? extends Number&gt;
</span><span class="c1"></span>
</code></pre></td></tr></table>
</div>
</div><p>下图显示了几个List类之间的关系:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/Java/%e9%80%9a%e9%85%8d%e7%ac%a6%e5%ad%90%e7%b1%bb%e5%9e%8b%e5%85%b3%e7%b3%bb.png"
        data-srcset="/images/Java/%E9%80%9A%E9%85%8D%E7%AC%A6%E5%AD%90%E7%B1%BB%E5%9E%8B%E5%85%B3%E7%B3%BB.png, /images/Java/%e9%80%9a%e9%85%8d%e7%ac%a6%e5%ad%90%e7%b1%bb%e5%9e%8b%e5%85%b3%e7%b3%bb.png 1.5x, /images/Java/%E9%80%9A%E9%85%8D%E7%AC%A6%E5%AD%90%E7%B1%BB%E5%9E%8B%E5%85%B3%E7%B3%BB.png 2x"
        data-sizes="auto"
        alt="/images/Java/%E9%80%9A%E9%85%8D%E7%AC%A6%E5%AD%90%E7%B1%BB%E5%9E%8B%E5%85%B3%E7%B3%BB.png"
        title="/images/Java/%E9%80%9A%E9%85%8D%E7%AC%A6%E5%AD%90%E7%B1%BB%E5%9E%8B%E5%85%B3%E7%B3%BB.png" /></p>
<h2 id="通配符捕获和辅助方法">通配符捕获和辅助方法</h2>
<p>有时编译器会推断通配符的类型,这种场景叫通配符捕获。</p>
<p>下面的WildcardError类在编译时会产生一个捕获错误:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WildcardError</span> <span class="o">{</span>

    <span class="kt">void</span> <span class="nf">foo</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">i</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">i</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//Java7
</span><span class="c1"></span><span class="n">WildcardError</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">6</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">method</span> <span class="n">set</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">applied</span> <span class="n">to</span> <span class="n">given</span> <span class="n">types</span><span class="o">;</span>
    <span class="n">i</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">i</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">));</span>
     <span class="o">^</span>
  <span class="n">required</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">CAP</span><span class="err">#</span><span class="n">1</span>
  <span class="n">found</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">Object</span>
  <span class="n">reason</span><span class="o">:</span> <span class="n">actual</span> <span class="n">argument</span> <span class="n">Object</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">by</span> <span class="n">method</span> <span class="n">invocation</span> <span class="n">conversion</span>
  <span class="n">where</span> <span class="n">E</span> <span class="n">is</span> <span class="n">a</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">E</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="n">declared</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span>
  <span class="n">where</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">is</span> <span class="n">a</span> <span class="n">fresh</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="n">from</span> <span class="n">capture</span> <span class="n">of</span> <span class="o">?</span>
<span class="n">1</span> <span class="n">error</span>
</code></pre></td></tr></table>
</div>
</div><p>你可以通过编写一个私有的辅助方法来捕获通配符。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WildcardFixed</span> <span class="o">{</span>

    <span class="kt">void</span> <span class="nf">foo</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">fooHelper</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="o">}</span>


    <span class="c1">// Helper method created so that the wildcard can be captured
</span><span class="c1"></span>    <span class="c1">// through type inference.
</span><span class="c1"></span>    <span class="c1">//通过该方法,编译器推断T就是被捕获的CAP#1变量的类型
</span><span class="c1"></span>    <span class="kd">private</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">fooHelper</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">l</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">l</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">l</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">));</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>约定辅助方法命名为<em>originalMethodName</em>Helper（原方法名+Helper）。</p>
<p>再看一个更复杂的例子：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WildcardErrorBad</span> <span class="o">{</span>

    <span class="kt">void</span> <span class="nf">swapFirst</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="n">l1</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="n">l2</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Number</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">l1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
      <span class="n">l1</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">l2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">));</span> <span class="c1">// expected a CAP#1 extends Number,
</span><span class="c1"></span>                            <span class="c1">// got a CAP#2 extends Number;
</span><span class="c1"></span>                            <span class="c1">// same bound, but different types
</span><span class="c1"></span>      <span class="n">l2</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">temp</span><span class="o">);</span>	    <span class="c1">// expected a CAP#1 extends Number,
</span><span class="c1"></span>                            <span class="c1">// got a Number
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">li</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">2</span><span class="o">,</span> <span class="n">3</span><span class="o">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">&gt;</span>  <span class="n">ld</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">10</span><span class="o">.</span><span class="na">10</span><span class="o">,</span> <span class="n">20</span><span class="o">.</span><span class="na">20</span><span class="o">,</span> <span class="n">30</span><span class="o">.</span><span class="na">30</span><span class="o">);</span>
<span class="c1">//这种情况没有辅助方法可以解决,因为把Double值添加到Integer列表中就是语法错误的
</span><span class="c1"></span><span class="n">swapFirst</span><span class="o">(</span><span class="n">li</span><span class="o">,</span> <span class="n">ld</span><span class="o">);</span>

<span class="c1">//
</span><span class="c1"></span><span class="n">WildcardErrorBad</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">7</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">method</span> <span class="n">set</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">applied</span> <span class="n">to</span> <span class="n">given</span> <span class="n">types</span><span class="o">;</span>
      <span class="n">l1</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">l2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">));</span> <span class="c1">// expected a CAP#1 extends Number,
</span><span class="c1"></span>        <span class="o">^</span>
  <span class="n">required</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">CAP</span><span class="err">#</span><span class="n">1</span>
  <span class="n">found</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">Number</span>
  <span class="n">reason</span><span class="o">:</span> <span class="n">actual</span> <span class="n">argument</span> <span class="n">Number</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">by</span> <span class="n">method</span> <span class="n">invocation</span> <span class="n">conversion</span>
  <span class="n">where</span> <span class="n">E</span> <span class="n">is</span> <span class="n">a</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">E</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="n">declared</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span>
  <span class="n">where</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">is</span> <span class="n">a</span> <span class="n">fresh</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="kd">extends</span> <span class="n">Number</span> <span class="n">from</span> <span class="n">capture</span> <span class="n">of</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">Number</span>
<span class="n">WildcardErrorBad</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">10</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">method</span> <span class="n">set</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">applied</span> <span class="n">to</span> <span class="n">given</span> <span class="n">types</span><span class="o">;</span>
      <span class="n">l2</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">temp</span><span class="o">);</span>      <span class="c1">// expected a CAP#1 extends Number,
</span><span class="c1"></span>        <span class="o">^</span>
  <span class="n">required</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">CAP</span><span class="err">#</span><span class="n">1</span>
  <span class="n">found</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">Number</span>
  <span class="n">reason</span><span class="o">:</span> <span class="n">actual</span> <span class="n">argument</span> <span class="n">Number</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">by</span> <span class="n">method</span> <span class="n">invocation</span> <span class="n">conversion</span>
  <span class="n">where</span> <span class="n">E</span> <span class="n">is</span> <span class="n">a</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">E</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="n">declared</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span>
  <span class="n">where</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">is</span> <span class="n">a</span> <span class="n">fresh</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="kd">extends</span> <span class="n">Number</span> <span class="n">from</span> <span class="n">capture</span> <span class="n">of</span> <span class="o">?</span> <span class="kd">extends</span> <span class="n">Number</span>
<span class="n">WildcardErrorBad</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="n">15</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">method</span> <span class="n">set</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">applied</span> <span class="n">to</span> <span class="n">given</span> <span class="n">types</span><span class="o">;</span>
        <span class="n">i</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">0</span><span class="o">,</span> <span class="n">i</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">));</span>
         <span class="o">^</span>
  <span class="n">required</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">CAP</span><span class="err">#</span><span class="n">1</span>
  <span class="n">found</span><span class="o">:</span> <span class="kt">int</span><span class="o">,</span><span class="n">Object</span>
  <span class="n">reason</span><span class="o">:</span> <span class="n">actual</span> <span class="n">argument</span> <span class="n">Object</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">converted</span> <span class="n">to</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">by</span> <span class="n">method</span> <span class="n">invocation</span> <span class="n">conversion</span>
  <span class="n">where</span> <span class="n">E</span> <span class="n">is</span> <span class="n">a</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">E</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="n">declared</span> <span class="n">in</span> <span class="kd">interface</span> <span class="nc">List</span>
  <span class="n">where</span> <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="n">is</span> <span class="n">a</span> <span class="n">fresh</span> <span class="n">type</span><span class="o">-</span><span class="n">variable</span><span class="o">:</span>
    <span class="n">CAP</span><span class="err">#</span><span class="n">1</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="n">from</span> <span class="n">capture</span> <span class="n">of</span> <span class="o">?</span>
<span class="n">3</span> <span class="n">errors</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="使用指南">使用指南</h2>
<p><strong>输入变量</strong></p>
<p>输入变量将数据提供给代码。例如copy(src,dest)方法src是输入参数</p>
<p><strong>输出变量</strong></p>
<p>输出变量接收在其他地方使用的数据。如copy(src,dest)方法dest是输出参数</p>
<p>当然有些变量既是输入也是输出,可以参考以下几点使用通配符:</p>
<ul>
<li>输入变量使用上界通配符定义(使用extends关键字)</li>
<li>输出变量使用下界通配符定义(使用super关键字)</li>
<li>可以使用Object类中方法访问输入变量时,使用无界通配符</li>
<li>代码需要访问既是输入又是输出的变量时,不要使用通配符</li>
</ul>
<p>这些指南不适用于方法返回类型。应避免使用通配符作为返回类型。</p>
<p>像List&lt;? extends &hellip; &gt;这样的列表可以认为它仅是只读的(并非严格意义上)。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">NaturalNumber</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">NaturalNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> <span class="o">}</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>

<span class="kd">class</span> <span class="nc">EvenNumber</span> <span class="kd">extends</span> <span class="n">NaturalNumber</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">EvenNumber</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">i</span><span class="o">);</span> <span class="o">}</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">EvenNumber</span><span class="o">&gt;</span> <span class="n">le</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">NaturalNumber</span><span class="o">&gt;</span> <span class="n">ln</span> <span class="o">=</span> <span class="n">le</span><span class="o">;</span>
<span class="n">ln</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">NaturalNumber</span><span class="o">(</span><span class="n">35</span><span class="o">));</span>  <span class="c1">// compile-time error
</span></code></pre></td></tr></table>
</div>
</div><p>因为List&lt;EvenNumber&gt;是List&lt;? extends NaturalNumber&gt;的子类型,所以可以把le赋值给ln。但是你不能使用ln添加自然数,因为它实际上是偶数列表,下列操作是可以的(从以下几点可以看出List&lt;? extends NaturalNumber&gt;并不是严格语意上的只读):</p>
<ul>
<li>添加null</li>
<li>调用clear</li>
<li>获取迭代器并调用remove</li>
<li>捕获通配符并写入列表中读取的元素</li>
</ul>
<h1 id="类型擦除">类型擦除</h1>
<p>Java语言引入泛型以在编译期提供严格类型检查。Java编译器应用类型擦除来实现泛型：</p>
<ul>
<li>如果类型参数是无界的，使用它们的边界或Object代替所有的类型参数</li>
<li>如有必要执行类型转换</li>
<li>生成桥接方法以保证在泛型类型继承中的多态性</li>
</ul>
<p>类型擦除确保没有为参数化类型创建新类,因此,泛型没有运行时开销。</p>
<h2 id="泛型类中的擦除">泛型类中的擦除</h2>
<p>Java编译器擦除所有类型参数,如果类型参数是有界的,则使用首个边界代替;如果类型参数是无界的,则使用Object代替。</p>
<p>考虑下面的泛型类：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">T</span> <span class="n">data</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Node</span><span class="o">(</span><span class="n">T</span> <span class="n">data</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">T</span> <span class="nf">getData</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">data</span><span class="o">;</span> <span class="o">}</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>因为类型参数是无界的,Java编译器使用Object代替:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Object</span> <span class="n">data</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Node</span><span class="o">(</span><span class="n">Object</span> <span class="n">data</span><span class="o">,</span> <span class="n">Node</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">getData</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">data</span><span class="o">;</span> <span class="o">}</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>当泛型类Node使用有界类型参数时,Java编译器使用首个边界类代替类型参数:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">T</span> <span class="n">data</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Node</span><span class="o">(</span><span class="n">T</span> <span class="n">data</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">T</span> <span class="nf">getData</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">data</span><span class="o">;</span> <span class="o">}</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>

<span class="c1">//泛型擦除后
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Comparable</span> <span class="n">data</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Node</span><span class="o">(</span><span class="n">Comparable</span> <span class="n">data</span><span class="o">,</span> <span class="n">Node</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Comparable</span> <span class="nf">getData</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">data</span><span class="o">;</span> <span class="o">}</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="泛型方法中的擦除">泛型方法中的擦除</h2>
<p>与泛型类中的擦除类似:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="c1">// Counts the number of occurrences of elem in anArray.
</span><span class="c1">//
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">int</span> <span class="nf">count</span><span class="o">(</span><span class="n">T</span><span class="o">[]</span> <span class="n">anArray</span><span class="o">,</span> <span class="n">T</span> <span class="n">elem</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="n">e</span> <span class="o">:</span> <span class="n">anArray</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">elem</span><span class="o">))</span>
            <span class="o">++</span><span class="n">cnt</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">cnt</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">//擦除后
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">count</span><span class="o">(</span><span class="n">Object</span><span class="o">[]</span> <span class="n">anArray</span><span class="o">,</span> <span class="n">Object</span> <span class="n">elem</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">Object</span> <span class="n">e</span> <span class="o">:</span> <span class="n">anArray</span><span class="o">)</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">elem</span><span class="o">))</span>
            <span class="o">++</span><span class="n">cnt</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">cnt</span><span class="o">;</span>
<span class="o">}</span>


</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">Shape</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
<span class="kd">class</span> <span class="nc">Rectangle</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Shape</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">(</span><span class="n">T</span> <span class="n">shape</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>

<span class="c1">//擦除后
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">(</span><span class="n">Shape</span> <span class="n">shape</span><span class="o">)</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="类型擦除的影响和桥接方法">类型擦除的影响和桥接方法</h2>
<p>以下例子展示了编译器在类型擦除的过程中如何创建桥接方法。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="n">T</span> <span class="n">data</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Node</span><span class="o">(</span><span class="n">T</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setData</span><span class="o">(</span><span class="n">T</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Node.setData&#34;</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyNode</span> <span class="kd">extends</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">MyNode</span><span class="o">(</span><span class="n">Integer</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">data</span><span class="o">);</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setData</span><span class="o">(</span><span class="n">Integer</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;MyNode.setData&#34;</span><span class="o">);</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">MyNode</span> <span class="n">mn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyNode</span><span class="o">(</span><span class="n">5</span><span class="o">);</span>
<span class="n">Node</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mn</span><span class="o">;</span>            <span class="c1">// A raw type - compiler throws an unchecked warning
</span><span class="c1"></span><span class="n">n</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="s">&#34;Hello&#34;</span><span class="o">);</span>     <span class="c1">// Causes a ClassCastException to be thrown.
</span><span class="c1"></span><span class="n">Integer</span> <span class="n">x</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="na">data</span><span class="o">;</span>   

<span class="c1">//类型擦出后
</span><span class="c1"></span><span class="n">MyNode</span> <span class="n">mn</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyNode</span><span class="o">(</span><span class="n">5</span><span class="o">);</span>
<span class="n">Node</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mn</span><span class="o">;</span>            <span class="c1">// A raw type - compiler throws an unchecked warning
</span><span class="c1"></span>                        <span class="c1">// Note: This statement could instead be the following:
</span><span class="c1"></span>                        <span class="c1">//     Node n = (Node)mn;
</span><span class="c1"></span>                        <span class="c1">// However, the compiler doesn&#39;t generate a cast because
</span><span class="c1"></span>                        <span class="c1">// it isn&#39;t required.
</span><span class="c1"></span><span class="n">n</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="s">&#34;Hello&#34;</span><span class="o">);</span>     <span class="c1">// Causes a ClassCastException to be thrown.
</span><span class="c1"></span><span class="n">Integer</span> <span class="n">x</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span><span class="n">mn</span><span class="o">.</span><span class="na">data</span><span class="o">;</span> 
</code></pre></td></tr></table>
</div>
</div><p><strong>桥接方法</strong></p>
<p>当编译一个继承于参数化类的类或接口,或实现一个参数化接口时,编译器会自动创建一个桥接方法。</p>
<p>类型擦除后，Node和MyNode类：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="n">Object</span> <span class="n">data</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Node</span><span class="o">(</span><span class="n">Object</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setData</span><span class="o">(</span><span class="n">Object</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Node.setData&#34;</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyNode</span> <span class="kd">extends</span> <span class="n">Node</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">MyNode</span><span class="o">(</span><span class="n">Integer</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">data</span><span class="o">);</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setData</span><span class="o">(</span><span class="n">Integer</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;MyNode.setData&#34;</span><span class="o">);</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>可以注意到类型擦除后,方法签名不匹配了,Node.setData(T)方法变成了Node.setData(Object)。也就是说MyNode.setData(Integer)没有重写Node.setData(Object)。</p>
<p>为了保证泛型擦出后的多态性，编译器生成了一个桥接方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">MyNode</span> <span class="kd">extends</span> <span class="n">Node</span> <span class="o">{</span>

    <span class="c1">// Bridge method generated by the compiler
</span><span class="c1"></span>    <span class="c1">//
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setData</span><span class="o">(</span><span class="n">Object</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">setData</span><span class="o">((</span><span class="n">Integer</span><span class="o">)</span> <span class="n">data</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setData</span><span class="o">(</span><span class="n">Integer</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;MyNode.setData&#34;</span><span class="o">);</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>桥接方法MyNode.setData(object)委托给了原始方法MyNode.setData(Integer)。所以n.setData(&ldquo;Hello&rdquo;);语句调用的是 <code>MyNode.setData(Object)</code>方法，所以才会抛出ClassCastException（因为&quot;Hello&quot;不能转换成Integer）。</p>
<h2 id="非具体类型non-reifiable-types">非具体类型（Non-Reifiable Types）</h2>
<p>具体类型指在类型信息在运行时可知道类型,包括:</p>
<ul>
<li>原始类型</li>
<li>非泛型类型</li>
<li>raw type</li>
<li>无界通配符调用</li>
</ul>
<p>非具体类型指类型信息在编译器被擦除的类型:调用不是由无界通配符定义的泛型类型。其类型信息在运行时不完全可知,如List&lt;String&gt;和List&lt;Number&gt;，JVM在运行时无法分辨这两者点区别。</p>
<p>在某些场景下非具体类型是不能使用的，如<code>instanceof</code>语句或作为数组元素。</p>
<p><strong>堆污染</strong></p>
<p>当一个参数化类型的变量指向一个不是这些参数化类型的对象时，就会发生堆污染。如果该程序执行某些操作会引起编译时的未受检警告，则会发生这种情况。当包含一个参数化类型的操作(如转换或方法调用)在编译时或运行时无法被验证时,就会生成未受检警告。例如，混用原始类型（raw type）和参数化类型时,或执行未受检转换时就会出现堆污染。</p>
<p><strong>含非具体类型形参的可变参方法的漏洞</strong></p>
<p>包含可变长入参的泛型方法可能造成堆污染：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArrayBuilder</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">addToList</span> <span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">listArg</span><span class="o">,</span> <span class="n">T</span><span class="o">...</span> <span class="n">elements</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="n">x</span> <span class="o">:</span> <span class="n">elements</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">listArg</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">faultyMethod</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;...</span> <span class="n">l</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Object</span><span class="o">[]</span> <span class="n">objectArray</span> <span class="o">=</span> <span class="n">l</span><span class="o">;</span>     <span class="c1">// Valid但是可能产生堆污染
</span><span class="c1"></span>    <span class="n">objectArray</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">42</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">l</span><span class="o">[</span><span class="n">0</span><span class="o">].</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>       <span class="c1">// ClassCastException thrown here
</span><span class="c1"></span>  <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HeapPollutionExample</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringListA</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringListB</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>

    <span class="n">ArrayBuilder</span><span class="o">.</span><span class="na">addToList</span><span class="o">(</span><span class="n">stringListA</span><span class="o">,</span> <span class="s">&#34;Seven&#34;</span><span class="o">,</span> <span class="s">&#34;Eight&#34;</span><span class="o">,</span> <span class="s">&#34;Nine&#34;</span><span class="o">);</span>
    <span class="n">ArrayBuilder</span><span class="o">.</span><span class="na">addToList</span><span class="o">(</span><span class="n">stringListB</span><span class="o">,</span> <span class="s">&#34;Ten&#34;</span><span class="o">,</span> <span class="s">&#34;Eleven&#34;</span><span class="o">,</span> <span class="s">&#34;Twelve&#34;</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">listOfStringLists</span> <span class="o">=</span>
      <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
    <span class="n">ArrayBuilder</span><span class="o">.</span><span class="na">addToList</span><span class="o">(</span><span class="n">listOfStringLists</span><span class="o">,</span>
      <span class="n">stringListA</span><span class="o">,</span> <span class="n">stringListB</span><span class="o">);</span>

    <span class="n">ArrayBuilder</span><span class="o">.</span><span class="na">faultyMethod</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&#34;Hello!&#34;</span><span class="o">),</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&#34;World!&#34;</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//warning: [varargs] Possible heap pollution from parameterized vararg type T
</span></code></pre></td></tr></table>
</div>
</div><p>当编译器进入一个可变长参数方法时，会将其转换成数组。但是Java语言不允许创建参数化类型的数组。Java编译器会将T&hellip;elements转换成Object[] elements，这可能产生堆污染。</p>
<p><strong>阻止带不可变类型的可变长参数方法的警告</strong></p>
<ul>
<li>@SafeVarargs</li>
<li>@SuppressWarnings({&ldquo;unchecked&rdquo;,&ldquo;varargs&rdquo;}):注意这无法抑制从方法调用处产生的警告</li>
</ul>
<h1 id="泛型约束">泛型约束</h1>
<h2 id="不能使用原始类型实例化泛型类型">不能使用原始类型实例化泛型类型</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">Pair</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">K</span> <span class="n">key</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">V</span> <span class="n">value</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Pair</span><span class="o">(</span><span class="n">K</span> <span class="n">key</span><span class="o">,</span> <span class="n">V</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// ...
</span><span class="c1"></span><span class="o">}</span>

<span class="n">Pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">,</span> <span class="kt">char</span><span class="o">&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">&lt;&gt;(</span><span class="n">8</span><span class="o">,</span> <span class="sc">&#39;a&#39;</span><span class="o">);</span>  <span class="c1">// compile-time error
</span></code></pre></td></tr></table>
</div>
</div><h2 id="不能创建类型参数的实例">不能创建类型参数的实例</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">append</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">E</span> <span class="n">elem</span> <span class="o">=</span> <span class="k">new</span> <span class="n">E</span><span class="o">();</span>  <span class="c1">// compile-time error
</span><span class="c1"></span>    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">elem</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>但是你可以通过反射创建类型参数的对象</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">append</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">cls</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">E</span> <span class="n">elem</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>   <span class="c1">// OK
</span><span class="c1"></span>    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">elem</span><span class="o">);</span>
<span class="o">}</span>
<span class="c1">//调用
</span><span class="c1"></span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ls</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">append</span><span class="o">(</span><span class="n">ls</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="不能声明为静态属性">不能声明为静态属性</h2>
<h2 id="不能转换或使用instanceof语句">不能转换或使用instanceof语句</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">rtti</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">list</span> <span class="k">instanceof</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;)</span> <span class="o">{</span>  <span class="c1">// compile-time error
</span><span class="c1"></span>        <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>

<span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">li</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span>  <span class="n">ln</span> <span class="o">=</span> <span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;)</span> <span class="n">li</span><span class="o">;</span>  <span class="c1">// compile-time error
</span></code></pre></td></tr></table>
</div>
</div><p>有时候转换是允许的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">l1</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">l2</span> <span class="o">=</span> <span class="o">(</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;)</span><span class="n">l1</span><span class="o">;</span>  <span class="c1">// OK
</span></code></pre></td></tr></table>
</div>
</div><p>另外，无界通配符可以使用instanceof：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">rtti</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">list</span> <span class="k">instanceof</span> <span class="n">ArrayList</span><span class="o">&lt;?&gt;)</span> <span class="o">{</span>  <span class="c1">// OK; instanceof requires a reifiable type
</span><span class="c1"></span>        <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="不能创建参数化类型的数组">不能创建参数化类型的数组</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;[]</span> <span class="n">arrayOfLists</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;[</span><span class="n">2</span><span class="o">];</span>  <span class="c1">// compile-time error
</span><span class="c1">//如果不同的类型插入到同一个数组将会产生异常
</span><span class="c1"></span><span class="n">Object</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">2</span><span class="o">];</span>
<span class="n">strings</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="s">&#34;hi&#34;</span><span class="o">;</span>   <span class="c1">// OK
</span><span class="c1"></span><span class="n">strings</span><span class="o">[</span><span class="n">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">100</span><span class="o">;</span>    <span class="c1">// An ArrayStoreException is thrown.
</span><span class="c1">//所以类似的，不允许这样创建参数化类型的数组
</span><span class="c1"></span><span class="n">Object</span><span class="o">[]</span> <span class="n">stringLists</span> <span class="o">=</span> <span class="k">new</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;[</span><span class="n">2</span><span class="o">];</span>  <span class="c1">// compiler error, but pretend it&#39;s allowed
</span><span class="c1"></span><span class="n">stringLists</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>   <span class="c1">// OK
</span><span class="c1"></span><span class="n">stringLists</span><span class="o">[</span><span class="n">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>  <span class="c1">// An ArrayStoreException should be thrown,
</span><span class="c1"></span>                                            <span class="c1">// but the runtime can&#39;t detect it.
</span></code></pre></td></tr></table>
</div>
</div><h2 id="不能创建捕获或抛出参数化类型的对象">不能创建，捕获或抛出参数化类型的对象</h2>
<p>泛型类不能直接或间接地继承Throwable类。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="c1">// Extends Throwable indirectly
</span><span class="c1"></span><span class="kd">class</span> <span class="nc">MathException</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="o">}</span>    <span class="c1">// compile-time error
</span><span class="c1"></span>
<span class="c1">// Extends Throwable directly
</span><span class="c1"></span><span class="kd">class</span> <span class="nc">QueueFullException</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">Throwable</span> <span class="o">{</span> <span class="cm">/* ... */</span> <span class="c1">// compile-time error
</span><span class="c1"></span>    
<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">,</span> <span class="n">J</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">J</span><span class="o">&gt;</span> <span class="n">jobs</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">J</span> <span class="n">job</span> <span class="o">:</span> <span class="n">jobs</span><span class="o">)</span>
            <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">T</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>   <span class="c1">// compile-time error
</span><span class="c1"></span>        <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>    
</code></pre></td></tr></table>
</div>
</div><p>但是可以在throws语句中使用类型参数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">Parser</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">parse</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">T</span> <span class="o">{</span>     <span class="c1">// OK
</span><span class="c1"></span>        <span class="c1">// ...
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="参数在类型擦除后一眼的方法不能重载">参数在类型擦除后一眼的方法不能重载</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Example</span> <span class="o">{</span>
    <span class="c1">//&#39;print(Set&lt;String&gt;)&#39; clashes with &#39;print(Set&lt;Integer&gt;)&#39;; both methods have same erasure
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">strSet</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">intSet</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2025-04-14</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/java%E6%B3%9B%E5%9E%8B/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/java%E5%9F%BA%E7%A1%80/">Java基础</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/b%E6%A0%91%E4%B8%8Eb-%E6%A0%91/" class="prev" rel="prev" title="B树与B&#43;树"><i class="fas fa-angle-left fa-fw"></i>B树与B&#43;树</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">H2oLo</div><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.92.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022 - 2025</span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br"/>
                    <span class="icp"><a href="https://beian.miit.gov.cn/" target="_blank">湘ICP备19007912号</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.stemmer.support.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.zh.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/typeit/typeit.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{},"data":{"id-1":"H2oLo","id-2":"H2oLo"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
